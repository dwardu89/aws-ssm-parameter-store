import { chain, fromStatic, memoize } from "@aws-sdk/property-provider";
import { loadConfig } from "./configLoader";
import { fromEnv } from "./fromEnv";
import { fromSharedConfigFiles } from "./fromSharedConfigFiles";
jest.mock("./fromEnv");
jest.mock("./fromSharedConfigFiles");
jest.mock("@aws-sdk/property-provider");
describe("loadConfig", function () {
    var configuration = {
        profile: "profile",
    };
    afterEach(function () {
        jest.clearAllMocks();
    });
    it("passes fromEnv(), fromSharedConfigFiles() and fromStatic() to chain", function () {
        var mockFromEnvReturn = "mockFromEnvReturn";
        fromEnv.mockReturnValueOnce(mockFromEnvReturn);
        var mockFromSharedConfigFilesReturn = "mockFromSharedConfigFilesReturn";
        fromSharedConfigFiles.mockReturnValueOnce(mockFromSharedConfigFilesReturn);
        var mockFromStatic = "mockFromStatic";
        fromStatic.mockReturnValueOnce(mockFromStatic);
        var envVarSelector = function (env) { return env["AWS_CONFIG_FOO"]; };
        var configKey = function (profile) { return profile["aws_config_foo"]; };
        var defaultValue = "foo-value";
        loadConfig({
            environmentVariableSelector: envVarSelector,
            configFileSelector: configKey,
            default: defaultValue,
        }, configuration);
        expect(fromEnv).toHaveBeenCalledTimes(1);
        expect(fromEnv).toHaveBeenCalledWith(envVarSelector);
        expect(fromSharedConfigFiles).toHaveBeenCalledTimes(1);
        expect(fromSharedConfigFiles).toHaveBeenCalledWith(configKey, configuration);
        expect(fromStatic).toHaveBeenCalledTimes(1);
        expect(fromStatic).toHaveBeenCalledWith(defaultValue);
        expect(chain).toHaveBeenCalledTimes(1);
        expect(chain).toHaveBeenCalledWith(mockFromEnvReturn, mockFromSharedConfigFilesReturn, mockFromStatic);
    });
    it("passes output of chain to memoize", function () {
        var mockChainReturn = "mockChainReturn";
        chain.mockReturnValueOnce(mockChainReturn);
        loadConfig({});
        expect(chain).toHaveBeenCalledTimes(1);
        expect(memoize).toHaveBeenCalledTimes(1);
        expect(memoize).toHaveBeenCalledWith(mockChainReturn);
    });
    it("returns output memoize", function () {
        var mockMemoizeReturn = "mockMemoizeReturn";
        memoize.mockReturnValueOnce(mockMemoizeReturn);
        expect(loadConfig({})).toEqual(mockMemoizeReturn);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlnTG9hZGVyLnNwZWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY29uZmlnTG9hZGVyLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFHeEUsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzVDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDcEMsT0FBTyxFQUFFLHFCQUFxQixFQUFvQixNQUFNLHlCQUF5QixDQUFDO0FBRWxGLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDdkIsSUFBSSxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO0FBQ3JDLElBQUksQ0FBQyxJQUFJLENBQUMsNEJBQTRCLENBQUMsQ0FBQztBQUV4QyxRQUFRLENBQUMsWUFBWSxFQUFFO0lBQ3JCLElBQU0sYUFBYSxHQUFxQjtRQUN0QyxPQUFPLEVBQUUsU0FBUztLQUNuQixDQUFDO0lBRUYsU0FBUyxDQUFDO1FBQ1IsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHFFQUFxRSxFQUFFO1FBQ3hFLElBQU0saUJBQWlCLEdBQUcsbUJBQW1CLENBQUM7UUFDN0MsT0FBcUIsQ0FBQyxtQkFBbUIsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1FBQzlELElBQU0sK0JBQStCLEdBQUcsaUNBQWlDLENBQUM7UUFDekUscUJBQW1DLENBQUMsbUJBQW1CLENBQUMsK0JBQStCLENBQUMsQ0FBQztRQUMxRixJQUFNLGNBQWMsR0FBRyxnQkFBZ0IsQ0FBQztRQUN2QyxVQUF3QixDQUFDLG1CQUFtQixDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQzlELElBQU0sY0FBYyxHQUFHLFVBQUMsR0FBc0IsSUFBSyxPQUFBLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFyQixDQUFxQixDQUFDO1FBQ3pFLElBQU0sU0FBUyxHQUFHLFVBQUMsT0FBZ0IsSUFBSyxPQUFBLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxFQUF6QixDQUF5QixDQUFDO1FBQ2xFLElBQU0sWUFBWSxHQUFHLFdBQVcsQ0FBQztRQUNqQyxVQUFVLENBQ1I7WUFDRSwyQkFBMkIsRUFBRSxjQUFjO1lBQzNDLGtCQUFrQixFQUFFLFNBQVM7WUFDN0IsT0FBTyxFQUFFLFlBQVk7U0FDdEIsRUFDRCxhQUFhLENBQ2QsQ0FBQztRQUNGLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN6QyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsb0JBQW9CLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDckQsTUFBTSxDQUFDLHFCQUFxQixDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdkQsTUFBTSxDQUFDLHFCQUFxQixDQUFDLENBQUMsb0JBQW9CLENBQUMsU0FBUyxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBQzdFLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM1QyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDdEQsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3ZDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxpQkFBaUIsRUFBRSwrQkFBK0IsRUFBRSxjQUFjLENBQUMsQ0FBQztJQUN6RyxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxtQ0FBbUMsRUFBRTtRQUN0QyxJQUFNLGVBQWUsR0FBRyxpQkFBaUIsQ0FBQztRQUN6QyxLQUFtQixDQUFDLG1CQUFtQixDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQzFELFVBQVUsQ0FBQyxFQUFTLENBQUMsQ0FBQztRQUN0QixNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdkMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3pDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUN4RCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx3QkFBd0IsRUFBRTtRQUMzQixJQUFNLGlCQUFpQixHQUFHLG1CQUFtQixDQUFDO1FBQzdDLE9BQXFCLENBQUMsbUJBQW1CLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUM5RCxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQVMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUM7SUFDM0QsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNoYWluLCBmcm9tU3RhdGljLCBtZW1vaXplIH0gZnJvbSBcIkBhd3Mtc2RrL3Byb3BlcnR5LXByb3ZpZGVyXCI7XG5pbXBvcnQgeyBQcm9maWxlIH0gZnJvbSBcIkBhd3Mtc2RrL3NoYXJlZC1pbmktZmlsZS1sb2FkZXIvc3JjXCI7XG5cbmltcG9ydCB7IGxvYWRDb25maWcgfSBmcm9tIFwiLi9jb25maWdMb2FkZXJcIjtcbmltcG9ydCB7IGZyb21FbnYgfSBmcm9tIFwiLi9mcm9tRW52XCI7XG5pbXBvcnQgeyBmcm9tU2hhcmVkQ29uZmlnRmlsZXMsIFNoYXJlZENvbmZpZ0luaXQgfSBmcm9tIFwiLi9mcm9tU2hhcmVkQ29uZmlnRmlsZXNcIjtcblxuamVzdC5tb2NrKFwiLi9mcm9tRW52XCIpO1xuamVzdC5tb2NrKFwiLi9mcm9tU2hhcmVkQ29uZmlnRmlsZXNcIik7XG5qZXN0Lm1vY2soXCJAYXdzLXNkay9wcm9wZXJ0eS1wcm92aWRlclwiKTtcblxuZGVzY3JpYmUoXCJsb2FkQ29uZmlnXCIsICgpID0+IHtcbiAgY29uc3QgY29uZmlndXJhdGlvbjogU2hhcmVkQ29uZmlnSW5pdCA9IHtcbiAgICBwcm9maWxlOiBcInByb2ZpbGVcIixcbiAgfTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBpdChcInBhc3NlcyBmcm9tRW52KCksIGZyb21TaGFyZWRDb25maWdGaWxlcygpIGFuZCBmcm9tU3RhdGljKCkgdG8gY2hhaW5cIiwgKCkgPT4ge1xuICAgIGNvbnN0IG1vY2tGcm9tRW52UmV0dXJuID0gXCJtb2NrRnJvbUVudlJldHVyblwiO1xuICAgIChmcm9tRW52IGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlT25jZShtb2NrRnJvbUVudlJldHVybik7XG4gICAgY29uc3QgbW9ja0Zyb21TaGFyZWRDb25maWdGaWxlc1JldHVybiA9IFwibW9ja0Zyb21TaGFyZWRDb25maWdGaWxlc1JldHVyblwiO1xuICAgIChmcm9tU2hhcmVkQ29uZmlnRmlsZXMgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWVPbmNlKG1vY2tGcm9tU2hhcmVkQ29uZmlnRmlsZXNSZXR1cm4pO1xuICAgIGNvbnN0IG1vY2tGcm9tU3RhdGljID0gXCJtb2NrRnJvbVN0YXRpY1wiO1xuICAgIChmcm9tU3RhdGljIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlT25jZShtb2NrRnJvbVN0YXRpYyk7XG4gICAgY29uc3QgZW52VmFyU2VsZWN0b3IgPSAoZW52OiBOb2RlSlMuUHJvY2Vzc0VudikgPT4gZW52W1wiQVdTX0NPTkZJR19GT09cIl07XG4gICAgY29uc3QgY29uZmlnS2V5ID0gKHByb2ZpbGU6IFByb2ZpbGUpID0+IHByb2ZpbGVbXCJhd3NfY29uZmlnX2Zvb1wiXTtcbiAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBcImZvby12YWx1ZVwiO1xuICAgIGxvYWRDb25maWcoXG4gICAgICB7XG4gICAgICAgIGVudmlyb25tZW50VmFyaWFibGVTZWxlY3RvcjogZW52VmFyU2VsZWN0b3IsXG4gICAgICAgIGNvbmZpZ0ZpbGVTZWxlY3RvcjogY29uZmlnS2V5LFxuICAgICAgICBkZWZhdWx0OiBkZWZhdWx0VmFsdWUsXG4gICAgICB9LFxuICAgICAgY29uZmlndXJhdGlvblxuICAgICk7XG4gICAgZXhwZWN0KGZyb21FbnYpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICBleHBlY3QoZnJvbUVudikudG9IYXZlQmVlbkNhbGxlZFdpdGgoZW52VmFyU2VsZWN0b3IpO1xuICAgIGV4cGVjdChmcm9tU2hhcmVkQ29uZmlnRmlsZXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICBleHBlY3QoZnJvbVNoYXJlZENvbmZpZ0ZpbGVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjb25maWdLZXksIGNvbmZpZ3VyYXRpb24pO1xuICAgIGV4cGVjdChmcm9tU3RhdGljKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgZXhwZWN0KGZyb21TdGF0aWMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGRlZmF1bHRWYWx1ZSk7XG4gICAgZXhwZWN0KGNoYWluKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgZXhwZWN0KGNoYWluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrRnJvbUVudlJldHVybiwgbW9ja0Zyb21TaGFyZWRDb25maWdGaWxlc1JldHVybiwgbW9ja0Zyb21TdGF0aWMpO1xuICB9KTtcblxuICBpdChcInBhc3NlcyBvdXRwdXQgb2YgY2hhaW4gdG8gbWVtb2l6ZVwiLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja0NoYWluUmV0dXJuID0gXCJtb2NrQ2hhaW5SZXR1cm5cIjtcbiAgICAoY2hhaW4gYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWVPbmNlKG1vY2tDaGFpblJldHVybik7XG4gICAgbG9hZENvbmZpZyh7fSBhcyBhbnkpO1xuICAgIGV4cGVjdChjaGFpbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChtZW1vaXplKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgZXhwZWN0KG1lbW9pemUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tDaGFpblJldHVybik7XG4gIH0pO1xuXG4gIGl0KFwicmV0dXJucyBvdXRwdXQgbWVtb2l6ZVwiLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja01lbW9pemVSZXR1cm4gPSBcIm1vY2tNZW1vaXplUmV0dXJuXCI7XG4gICAgKG1lbW9pemUgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWVPbmNlKG1vY2tNZW1vaXplUmV0dXJuKTtcbiAgICBleHBlY3QobG9hZENvbmZpZyh7fSBhcyBhbnkpKS50b0VxdWFsKG1vY2tNZW1vaXplUmV0dXJuKTtcbiAgfSk7XG59KTtcbiJdfQ==